<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate (non-)oceanic islands with given parameters under a time-dependent regime — DAISIE_sim_time_dep • DAISIE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate (non-)oceanic islands with given parameters under a time-dependent regime — DAISIE_sim_time_dep"><meta name="description" content="This function simulates islands with given cladogenesis,
extinction, Kprime, immigration and anagenesis parameters, all of which
modelled as time-dependent parameters.
Time dependency aims to capture the
effect of area changes islands undego from their emergence until subsidence.
Thus, oceanic, volcanic island ontogeny scenarios can be modelled (by a
beta function), as well as the effect of sea level fluctuations (modelled
through a sine function). See paramter entry area_pars for details.
Both island ontogeny and sea level fluctuations are allowed to operate
simultaneuosly.
This function also allows for the simulation of
non-oceanic islands, generating islands for which the starting condition
includes potential endemic and non-endemic species."><meta property="og:description" content="This function simulates islands with given cladogenesis,
extinction, Kprime, immigration and anagenesis parameters, all of which
modelled as time-dependent parameters.
Time dependency aims to capture the
effect of area changes islands undego from their emergence until subsidence.
Thus, oceanic, volcanic island ontogeny scenarios can be modelled (by a
beta function), as well as the effect of sea level fluctuations (modelled
through a sine function). See paramter entry area_pars for details.
Both island ontogeny and sea level fluctuations are allowed to operate
simultaneuosly.
This function also allows for the simulation of
non-oceanic islands, generating islands for which the starting condition
includes potential endemic and non-endemic species."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DAISIE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DAISIE_FAQs.html">DAISIE FAQs</a></li>
    <li><a class="dropdown-item" href="../articles/demo_CSvsIW.html">Demo: Fitting clade-specific and island-wide diversity-dependence models in DAISIE</a></li>
    <li><a class="dropdown-item" href="../articles/demo_optimize.html">Demo optimizing parameters</a></li>
    <li><a class="dropdown-item" href="../articles/demo_sim.html">Demo simulating islands</a></li>
    <li><a class="dropdown-item" href="../articles/stac_key.html">DAISIE `stac` values</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rsetienne/DAISIE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate (non-)oceanic islands with given parameters under a time-dependent regime</h1>
      <small class="dont-index">Source: <a href="https://github.com/rsetienne/DAISIE/blob/master/R/DAISIE_sim_time_dep.R" class="external-link"><code>R/DAISIE_sim_time_dep.R</code></a></small>
      <div class="d-none name"><code>DAISIE_sim_time_dep.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function simulates islands with given cladogenesis,
extinction, Kprime, immigration and anagenesis parameters, all of which
modelled as time-dependent parameters.</p>
<p>Time dependency aims to capture the
effect of area changes islands undego from their emergence until subsidence.
Thus, oceanic, volcanic island ontogeny scenarios can be modelled (by a
beta function), as well as the effect of sea level fluctuations (modelled
through a sine function). See paramter entry <code>area_pars</code> for details.
Both island ontogeny and sea level fluctuations are allowed to operate
simultaneuosly.</p>
<p>This function also allows for the simulation of
non-oceanic islands, generating islands for which the starting condition
includes potential endemic and non-endemic species.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DAISIE_sim_time_dep</span><span class="op">(</span></span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">M</span>,</span>
<span>  <span class="va">pars</span>,</span>
<span>  <span class="va">replicates</span>,</span>
<span>  <span class="va">area_pars</span>,</span>
<span>  <span class="va">hyper_pars</span>,</span>
<span>  divdepmodel <span class="op">=</span> <span class="st">"CS"</span>,</span>
<span>  nonoceanic_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  num_guilds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_freq <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  plot_sims <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  island_ontogeny <span class="op">=</span> <span class="st">"const"</span>,</span>
<span>  sea_level <span class="op">=</span> <span class="st">"const"</span>,</span>
<span>  extcutoff <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  cond <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p></dd>


<dt id="arg-pars">pars<a class="anchor" aria-label="anchor" href="#arg-pars"></a></dt>
<dd><p>A numeric vector containing the model parameters:</p><ul><li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)</p></li>
<li><p><code>pars[2]</code>: mu (extinction rate)</p></li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
  independence.</p></li>
<li><p><code>pars[4]</code>: gamma (immigration rate)</p></li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)</p></li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
  or rate set 2 in rate shift model</p></li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
  set 2 in rate shift model</p></li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
  set 2 in rate shift model, set K=Inf for diversity independence.</p></li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
  or rate set 2 in rate shift model</p></li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
  species or rate set 2 in rate shift model</p></li>
</ul><p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="DAISIE_sim_relaxed_rate.html">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p></dd>


<dt id="arg-replicates">replicates<a class="anchor" aria-label="anchor" href="#arg-replicates"></a></dt>
<dd><p>Integer specifying number of island replicates to be
simulated.</p></dd>


<dt id="arg-area-pars">area_pars<a class="anchor" aria-label="anchor" href="#arg-area-pars"></a></dt>
<dd><p>A named list containing area and sea level parameters as
created by <code><a href="create_area_pars.html">create_area_pars</a>()</code>:</p><ul><li><p>[1]: maximum area</p></li>
<li><p>[2]: current area</p></li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
  peak area is achieved</p></li>
<li><p>[4]: total island age</p></li>
<li><p>[5]: amplitude of area fluctuation from sea level</p></li>
<li><p>[6]: frequency of sine wave of area change from sea level</p></li>
<li><p>[7]: angle of the slope of the island</p></li>
</ul></dd>


<dt id="arg-hyper-pars">hyper_pars<a class="anchor" aria-label="anchor" href="#arg-hyper-pars"></a></dt>
<dd><p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="create_hyper_pars.html">create_hyper_pars</a>()</code>:</p><ul><li><p>[1]: is d the scaling parameter for exponent for calculating
  cladogenesis rate</p></li>
<li><p>[2]: is x the exponent for calculating extinction rate</p></li>
</ul></dd>


<dt id="arg-divdepmodel">divdepmodel<a class="anchor" aria-label="anchor" href="#arg-divdepmodel"></a></dt>
<dd><p>Option divdepmodel = 'CS' runs a model with clade-specific
carrying capacity, where diversity-dependence operates only within single
clades, i.e. only among species originating from the same mainland
colonist. Option divdepmodel = 'IW' runs a model with island-wide
carrying capacity, where diversity-dependence operates within and among
clades. Option divdepmodel = 'GW' runs a model with diversity-dependence
operates within a guild.</p></dd>


<dt id="arg-nonoceanic-pars">nonoceanic_pars<a class="anchor" aria-label="anchor" href="#arg-nonoceanic-pars"></a></dt>
<dd><p>A vector of length two with:</p><ul><li><p>[1]: the probability of sampling a species from the mainland</p></li>
<li><p>[2]: the probability of the species sampled from the mainland
  being nonendemic</p></li>
</ul></dd>


<dt id="arg-num-guilds">num_guilds<a class="anchor" aria-label="anchor" href="#arg-num-guilds"></a></dt>
<dd><p>The number of guilds on the mainland. The number of
mainland species is divided by the number of guilds when
<code>divdepmodel = "GW"</code></p></dd>


<dt id="arg-sample-freq">sample_freq<a class="anchor" aria-label="anchor" href="#arg-sample-freq"></a></dt>
<dd><p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p></dd>


<dt id="arg-plot-sims">plot_sims<a class="anchor" aria-label="anchor" href="#arg-plot-sims"></a></dt>
<dd><p><code>Default = TRUE</code> plots species-through-time (STT)
plots. It detects how many types of species are present. If only one type
of species is present, STT is plotted for all species. If two types are
present, three plots are produced: STT for all, STT for type 1 and STT for
type 2.</p></dd>


<dt id="arg-island-ontogeny">island_ontogeny<a class="anchor" aria-label="anchor" href="#arg-island-ontogeny"></a></dt>
<dd><p>In <code>DAISIE_sim_time_dep()</code>,
<code><a href="DAISIE_ML.html">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p></dd>


<dt id="arg-sea-level">sea_level<a class="anchor" aria-label="anchor" href="#arg-sea-level"></a></dt>
<dd><p>In <code>DAISIE_sim_time_dep()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p></dd>


<dt id="arg-extcutoff">extcutoff<a class="anchor" aria-label="anchor" href="#arg-extcutoff"></a></dt>
<dd><p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p></dd>


<dt id="arg-cond">cond<a class="anchor" aria-label="anchor" href="#arg-cond"></a></dt>
<dd><p>cond = 0 : conditioning on island age <br> cond = 1 :
conditioning on island age and non-extinction of the island biota <br>.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A numeric vector of length 1, which in simulations and
`DAISIEdataprep()` can be `1` or `0`, where `1` gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: `0` does not print, `1` prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), `2` prints the same as `1 and also the
intermediate output of the parameters and loglikelihood, while `3` the
same as `2` and prints intermediate progress during likelihood computation.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Any arguments to pass on to plotting functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list. The highest level of the least corresponds to each individual
replciate. The first element of each replicate is composed of island
information containing:</p><ul><li><p><code>$island_age</code>: A numeric with the island age.</p></li>
<li><p><code>$not_present</code>: A numeric with the number of mainland lineages
  that are not present on the island.</p></li>
<li><p><code>$stt_all</code>: STT table for all species on the island
    (nI - number of non-endemic species; nA - number of anagenetic species,
    nC - number of cladogenetic species, present - number of independent
    colonisations present)</p></li>
<li><p><code>$brts_table</code>: Only for simulations under <code>"IW"</code>. Table
containing information on order of events in the data, for use in maximum
likelihood optimization.).</p></li>
</ul><p>The subsequent elements of the list pertaining to each replcate contain
information on a single colonist lineage on the island and have 4 components:</p><ul><li><p><code>$branching_times</code>: island age and stem age of the
    population/species in the case of Non-endemic, Non-endemic_MaxAge and
    Endemic anagenetic species. For cladogenetic species these should
    be island age and branching times of the radiation including the
    stem age of the radiation.</p></li>
<li><p><code>$stac</code>: An integer ranging from 1 to 4
  indicating the status of the colonist:</p><ol><li><p>Non_endemic_MaxAge</p></li>
<li><p>Endemic</p></li>
<li><p>Endemic&amp;Non_Endemic</p></li>
<li><p>Non_endemic_MaxAge</p></li>
</ol></li>
<li><p><code>$missing_species</code>: number of island species that were
not sampled for particular clade (only applicable for endemic clades)</p></li>
<li><p><code>$type_1or2</code>: whether the colonist belongs to type 1 or type 2</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.</p>
<p>Valente, L.M., Etienne, R.S. and Phillimore, A.B. (2014). The effects of
island ontogeny on species diversity and phylogeny.
Proceedings of the Royal Society B: Biological Sciences 281(1784),
p.20133227.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="DAISIE_plot_sims.html">DAISIE_plot_sims</a>()</code> for plotting STT of simulation
outputs.</p>
<p>Other simulation models:
<code><a href="DAISIE_sim.html">DAISIE_sim</a>()</code>,
<code><a href="DAISIE_sim_cr_shift.html">DAISIE_sim_cr_shift</a>()</code>,
<code><a href="DAISIE_sim_relaxed_rate.html">DAISIE_sim_relaxed_rate</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Luis Valente and Albert Phillimore</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rampal S. Etienne, Luis Valente, Albert B. Phillimore, Bart Haegeman, Joshua W. Lambert, Pedro Santos Neves, Shu Xie, Richèl J.C. Bilderbeek, Hanno Hildenbrandt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

