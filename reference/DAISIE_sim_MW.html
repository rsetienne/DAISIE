<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate multiple islands based on hyperparameters that describe relationships between area, isolation and local parameters — DAISIE_sim_MW • DAISIE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate multiple islands based on hyperparameters that describe relationships between area, isolation and local parameters — DAISIE_sim_MW"><meta name="description" content="This function simulates islands of given age, area and isolation.
A list of islands/archipelagos with this information is provided as a data frame
object (in the example,
the archipelago_data from Valente et al 2020 Nature).
For each island, local parameters are first calculated based on hyperparameters describing
the dependency of rates on island area and isolation. Simulations are then run for each island,
from island birth until the given island age based on the
local parameters for each island (using the DAISIE_sim function).
Returns R list object that contains the simulated islands."><meta property="og:description" content="This function simulates islands of given age, area and isolation.
A list of islands/archipelagos with this information is provided as a data frame
object (in the example,
the archipelago_data from Valente et al 2020 Nature).
For each island, local parameters are first calculated based on hyperparameters describing
the dependency of rates on island area and isolation. Simulations are then run for each island,
from island birth until the given island age based on the
local parameters for each island (using the DAISIE_sim function).
Returns R list object that contains the simulated islands."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DAISIE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DAISIE_FAQs.html">DAISIE FAQs</a></li>
    <li><a class="dropdown-item" href="../articles/demo_CSvsIW.html">Demo: Fitting clade-specific and island-wide diversity-dependence models in DAISIE</a></li>
    <li><a class="dropdown-item" href="../articles/demo_optimize.html">Demo optimizing parameters</a></li>
    <li><a class="dropdown-item" href="../articles/demo_sim.html">Demo simulating islands</a></li>
    <li><a class="dropdown-item" href="../articles/stac_key.html">DAISIE `stac` values</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rsetienne/DAISIE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate multiple islands based on hyperparameters that describe relationships between area, isolation and local parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/rsetienne/DAISIE/blob/master/R/DAISIE_sim_MW.R" class="external-link"><code>R/DAISIE_sim_MW.R</code></a></small>
      <div class="d-none name"><code>DAISIE_sim_MW.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function simulates islands of given age, area and isolation.
A list of islands/archipelagos with this information is provided as a data frame
object (in the example,
the archipelago_data from Valente et al 2020 Nature).
For each island, local parameters are first calculated based on hyperparameters describing
the dependency of rates on island area and isolation. Simulations are then run for each island,
from island birth until the given island age based on the
local parameters for each island (using the DAISIE_sim function).</p>
<p>Returns R list object that contains the simulated islands.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DAISIE_sim_MW</span><span class="op">(</span></span>
<span>  <span class="va">archipelago_data</span>,</span>
<span>  <span class="va">M</span>,</span>
<span>  <span class="va">pars</span>,</span>
<span>  <span class="va">replicates</span>,</span>
<span>  divdepmodel <span class="op">=</span> <span class="st">"CS"</span>,</span>
<span>  distance_dep <span class="op">=</span> <span class="st">"power"</span>,</span>
<span>  cladogenesis_dep <span class="op">=</span> <span class="st">"NULL"</span>,</span>
<span>  sigmoidal_par <span class="op">=</span> <span class="st">"NULL"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-archipelago-data">archipelago_data<a class="anchor" aria-label="anchor" href="#arg-archipelago-data"></a></dt>
<dd><p>Object (data.frame) containing a table with columns with
the following names:
Archipelago: names of the archipelagos or islands to be simulated;
Area - the area of the archipelago/island;
Age: Age of the oldest island in the archipelago, or age of the island if single island.
Distance - distance to the mainland (or other applicable isolation metric).
As an example, the dataset from Valente et al 2020 for 41 archipelagos is provided in data(archipelago_data).</p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>The size of the mainland pool, i.e the number of species that can
potentially colonize the island(s).</p></dd>


<dt id="arg-pars">pars<a class="anchor" aria-label="anchor" href="#arg-pars"></a></dt>
<dd><p>Contains the model hyperparameters:
<br><br><code>pars[1]</code> corresponds to lambda^c0 (initial cladogenesis rate)
<br><code>pars[2]</code> corresponds to y (dependency of cladogenesis on area)
0 - no dependency, positive value - cladogenesis increases with area,
negative value - cladogenesis decreases with area
<br><code>pars[3]</code> corresponds to mu_0 (initial extinction rate)
<br><code>pars[4]</code> corresponds to x (dependency of extinction on area)
0 - no dependency, positive value - extinction increases with area,
negative value - extinction decreases with area.
<br><code>pars[5]</code> corresponds to K_0  (initial
carrying capacity). Set K=Inf for non-diversity dependence.
<br><code>pars[6]</code> corresponds to z
(dependency of K on area). 0 - no dependency, positive value - K increases with area,
negative value - K decreases with area.
<br><code>pars[7]</code> corresponds to gamma_0 (initial immigration rate)
<br><code>pars[8]</code> corresponds to alpha (dependency of immigration on island isolation).
0 - no dependency, positive value - immigration increases with distance,
negative value - immigration decreases with distance
<br><code>pars[9]</code> corresponds to lambda^a_0 (initial anagenesis rate)
<br><code>pars[10]</code> corresponds to beta (dependency of anagenesis on island isolation).
0 - no dependency,positive value - anagenesis increases with distance, negative value
- anagenesis decreases with distance.
<br><code>pars[11]</code> corresponds to d0, parameter that describes
interactive/additive effect of isolation and area on cladogenesis (power models);
or that describes the shape of the sigmoidal relationship between
isolation and a parameter (sigmoidal models).</p></dd>


<dt id="arg-replicates">replicates<a class="anchor" aria-label="anchor" href="#arg-replicates"></a></dt>
<dd><p>Number of island replicates to be simulated per island in
the table archipelago_data. If there are 5 islands in archipelago_data, and number of
replicates is set to 10, 50 islands will be simulated.</p></dd>


<dt id="arg-divdepmodel">divdepmodel<a class="anchor" aria-label="anchor" href="#arg-divdepmodel"></a></dt>
<dd><p>Option divdepmodel = 'CS' runs model with clade-specific
carrying capacity, where diversity-dependence operates only within single
clades, i.e. only among species originating from the same mainland
colonist.<br> Option divdepmodel = 'IW' runs model with island-wide carrying
capacity, where diversity-dependence operates within and among clades.</p></dd>


<dt id="arg-distance-dep">distance_dep<a class="anchor" aria-label="anchor" href="#arg-distance-dep"></a></dt>
<dd><p>Shape of dependency of parameter with distance. Can be of type <br> 'power'
or type <br> 'sigmoidal'.</p></dd>


<dt id="arg-cladogenesis-dep">cladogenesis_dep<a class="anchor" aria-label="anchor" href="#arg-cladogenesis-dep"></a></dt>
<dd><p>When distance_dep = 'power' is specified, cladogenesis_dep specifies
the type of effect of area and isolation on cladogenesis. The possible options are:
<br> 'NULL' (no additive or interactive effect of area on isolation,
same as models M1-M14 in Valente et al 2020)
<br> 'additive' (additive effect of area and isolation on cladogenesis,
same as model M15 in Valente et al 2020)
<br> 'interactive' (interactive effect of area and isolation on cladogenesis,
same as models M16 and M19 in Valente et al 2020)
<br> 'interactive1' (interactive effect of area and isolation on cladogenesis,
same as model M17 in Valente et al 2020)
<br> 'interactive2' (interactive effect of area and isolation on cladogenesis,
same as model M18 in Valente et al 2020)</p></dd>


<dt id="arg-sigmoidal-par">sigmoidal_par<a class="anchor" aria-label="anchor" href="#arg-sigmoidal-par"></a></dt>
<dd><p>When distance_dep = 'sigmoidal', sigmoidal_par specifies
to which parameter the sigmoidal relationship with distance is applied.
Options: <br> 'cladogenesis'<br> 'anagenesis' <br> 'colonisation'.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>For each island listed in the rows of archipelago_data, a given number of islands
is simulated depending on the number of replicates specified. The simulations for
each island in archipelago_data are an element of the list, which can be called using [[x]].
Individual replicates for an island can be called with [[x]][[x]]
For example if the object is called global_sims, the 1st replicate for the first island
can be called using global_sims[[1]][[1]].
The 3rd replicate of the 4th island is called with global_sims[[4]][[3]]
Each of the island replicates is a list in itself. The first (e.g.
global_sims[[x]][[x]][[1]]) element of that list has the following
components: <br><code>$island_age</code> - the island or archipelago age <code>$not_present</code>
- the number of mainland lineages that are not present on the island <br><code>$stt_all</code> - STT table for all species on the archipelago/island (nI - number of
non-endemic species; nA - number of anagenetic species, nC - number of
cladogenetic species, present - number of independent colonisations present)
<br><code>$area</code> Area of the island or archipelago <br><code>$distance</code> Distance to the mainland
<br><code>$name</code> Name of the island or archipelago <br></p>
<p>The subsequent elements of the list each contain information on a single
colonist lineage on the island and has 4 components:<br><code>$branching_times</code> - island age and stem age of the population/species
in the case of Non-endemic, Non-endemic_MaxAge and Endemic with no close extant
relatives on the islands
species. For cladogenetic species these should be island age and branching
times of the radiation including the stem age of the radiation.<br><code>$stac</code> - the status of the colonist <br> *
Endemic: 2 <br> * Endemic&amp;Non_Endemic: 3 <br> * Non_endemic: 4 <br><code>$missing_species</code> - number of island species that were not sampled for
particular clade (only applicable for endemic clades) <br></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Valente, LM, Phillimore AB, Melo M, Warren B, Clegg S, Havenstein K,
Tiedemann R, Illera JC, Thebaud C, Aschenbach T and  Etienne RS (2020).
A simple dynamic model explain island bird diversity worldwide. Nature, 579, 92-96.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="DAISIE_sim.html">DAISIE_sim_cr</a>()</code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Luis Valente, Albert Phillimore, Rampal Etienne</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Simulate 10 replicates for the each of the 41 archipelagos in the archipelago_data table,</span></span></span>
<span class="r-in"><span><span class="co">##based on the hyperparameters of the M19 model (preferred model in Valente et al 2020)</span></span></span>
<span class="r-in"><span><span class="co">## and the age, area and isolation values given in the archipelago_data table.</span></span></span>
<span class="r-in"><span><span class="co">## Mainland pool size of 1000, clade-specific carrying capacity. The M19 model is a</span></span></span>
<span class="r-in"><span><span class="co">## power model with an interactive effect of area and isolation on cladogenesis.</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## data(archipelago_data)</span></span></span>
<span class="r-in"><span><span class="co">## result &lt;- DAISIE_sim_MW(</span></span></span>
<span class="r-in"><span><span class="co">## archipelago_data = archipelago_data,</span></span></span>
<span class="r-in"><span><span class="co">## M = 1000,</span></span></span>
<span class="r-in"><span><span class="co">## pars = c(0.040073803,  0,  1.945656546,  0.150429656,  Inf,  0,  67.25643672,</span></span></span>
<span class="r-in"><span><span class="co">## 0.293635061,  0.059096872,  0.382688527,  0.026510781),</span></span></span>
<span class="r-in"><span><span class="co">## replicates = 10,</span></span></span>
<span class="r-in"><span><span class="co">## distance_dep = 'power',</span></span></span>
<span class="r-in"><span><span class="co">## cladogenesis_dep = 'interactive',</span></span></span>
<span class="r-in"><span><span class="co">## sigmoidal_par = 'NULL',</span></span></span>
<span class="r-in"><span><span class="co">## divdepmodel = 'CS')</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rampal S. Etienne, Luis Valente, Albert B. Phillimore, Bart Haegeman, Joshua W. Lambert, Pedro Santos Neves, Shu Xie, Richèl J.C. Bilderbeek, Hanno Hildenbrandt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

