<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Maximization of the loglikelihood under the DAISIE model with clade-specific diversity-dependence — DAISIE_ML • DAISIE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximization of the loglikelihood under the DAISIE model with clade-specific diversity-dependence — DAISIE_ML"><meta name="description" content="This function computes the maximum likelihood estimates of the parameters of
the DAISIE model with clade-specific diversity-dependence for data from
lineages colonizing an island. It also outputs the corresponding
loglikelihood that can be used in model comparisons.
The result of sort(c(idparsopt, idparsfix, idparsnoshift)) should be
identical to c(1:10). If not, an error is reported that the input is
incoherent. The same happens when the length of initparsopt is different
from the length of idparsopt, and the length of parsfix is different from
the length of idparsfix. Including the 11th parameter (p_f) in either
idparsopt or idparsfix (and therefore initparsopt or parsfix) is optional.
If this parameter is not specified, then the information in the data is
used, otherwise the information in the data is overruled."><meta property="og:description" content="This function computes the maximum likelihood estimates of the parameters of
the DAISIE model with clade-specific diversity-dependence for data from
lineages colonizing an island. It also outputs the corresponding
loglikelihood that can be used in model comparisons.
The result of sort(c(idparsopt, idparsfix, idparsnoshift)) should be
identical to c(1:10). If not, an error is reported that the input is
incoherent. The same happens when the length of initparsopt is different
from the length of idparsopt, and the length of parsfix is different from
the length of idparsfix. Including the 11th parameter (p_f) in either
idparsopt or idparsfix (and therefore initparsopt or parsfix) is optional.
If this parameter is not specified, then the information in the data is
used, otherwise the information in the data is overruled."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DAISIE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DAISIE_FAQs.html">DAISIE FAQs</a></li>
    <li><a class="dropdown-item" href="../articles/demo_CSvsIW.html">Demo: Fitting clade-specific and island-wide diversity-dependence models in DAISIE</a></li>
    <li><a class="dropdown-item" href="../articles/demo_optimize.html">Demo optimizing parameters</a></li>
    <li><a class="dropdown-item" href="../articles/demo_sim.html">Demo simulating islands</a></li>
    <li><a class="dropdown-item" href="../articles/stac_key.html">DAISIE `stac` values</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rsetienne/DAISIE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Maximization of the loglikelihood under the DAISIE model with clade-specific diversity-dependence</h1>
      <small class="dont-index">Source: <a href="https://github.com/rsetienne/DAISIE/blob/master/R/DAISIE_ML_CS.R" class="external-link"><code>R/DAISIE_ML_CS.R</code></a></small>
      <div class="d-none name"><code>DAISIE_ML.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes the maximum likelihood estimates of the parameters of
the DAISIE model with clade-specific diversity-dependence for data from
lineages colonizing an island. It also outputs the corresponding
loglikelihood that can be used in model comparisons.
The result of sort(c(idparsopt, idparsfix, idparsnoshift)) should be
identical to c(1:10). If not, an error is reported that the input is
incoherent. The same happens when the length of initparsopt is different
from the length of idparsopt, and the length of parsfix is different from
the length of idparsfix.<br> Including the 11th parameter (p_f) in either
idparsopt or idparsfix (and therefore initparsopt or parsfix) is optional.
If this parameter is not specified, then the information in the data is
used, otherwise the information in the data is overruled.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DAISIE_ML_CS</span><span class="op">(</span></span>
<span>  <span class="va">datalist</span>,</span>
<span>  datatype <span class="op">=</span> <span class="st">"single"</span>,</span>
<span>  <span class="va">initparsopt</span>,</span>
<span>  <span class="va">idparsopt</span>,</span>
<span>  <span class="va">parsfix</span>,</span>
<span>  <span class="va">idparsfix</span>,</span>
<span>  idparsnoshift <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  idparsmat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  ddmodel <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cond <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  island_ontogeny <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  eqmodel <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  x_E <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  x_I <span class="op">=</span> <span class="fl">0.98</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-04</span>, <span class="fl">1e-05</span>, <span class="fl">1e-07</span><span class="op">)</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idparsopt</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  methode <span class="op">=</span> <span class="st">"lsodes"</span>,</span>
<span>  optimmethod <span class="op">=</span> <span class="st">"subplex"</span>,</span>
<span>  CS_version <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  tolint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-16</span>, <span class="fl">1e-10</span><span class="op">)</span>,</span>
<span>  jitter <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  num_cycles <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  function_to_optimize <span class="op">=</span> <span class="st">"DAISIE_exact"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-datalist">datalist<a class="anchor" aria-label="anchor" href="#arg-datalist"></a></dt>
<dd><p>Data object containing information on colonisation and
branching times. This object can be generated using the DAISIE_dataprep
function, which converts a user-specified data table into a data object,
but the object can of course also be entered directly.
It is an R list object with the following elements.<br> The first element
of the list has two or three components: <br><br><code>$island_age</code> - the
island age <br> Then, depending on whether a distinction between types is
made, we have:<br><code>$not_present</code> - the number of mainland lineages
that are not present on the island <br> or:<br><code>$not_present_type1</code> -
the number of mainland lineages of type 1 that are not present on the
island <br><code>$not_present_type2</code> - the number of mainland lineages of
type 2 that are not present on the island <br><br> The remaining elements of
the list each contains information on a single colonist lineage on the
island and has 5 components:<br><br><code>$colonist_name</code> - the name of the
species or clade that colonized the island <br><code>$branching_times</code> -
island age followed by stem age of the population/species in the case of
Non-endemic, Non-endemic_MaxAge species and Endemic species with no close relatives
on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island clade
including the stem age of the clade<br><code>$stac</code> - the
status of the colonist <br><br> * Non_endemic_MaxAge: 1 <br> * Endemic: 2
<br> * Endemic&amp;Non_Endemic: 3 <br> * Non_Endemic: 4 <br>
* Endemic_Singleton_MaxAge: 5 <br> * Endemic_Clade_MaxAge: 6
<br> * Endemic&amp;Non_Endemic_Clade_MaxAge: 7 <br><br><code>$missing_species</code> - number of island species that were not
sampled for particular clade (only applicable for endemic clades) <br><code>$type1or2</code> - whether the colonist belongs to type 1 or type 2 <br></p></dd>


<dt id="arg-datatype">datatype<a class="anchor" aria-label="anchor" href="#arg-datatype"></a></dt>
<dd><p>Sets the type of data: 'single' for a single island or
archipelago treated as one, and 'multiple' for multiple archipelagoes
potentially sharing the same parameters.</p></dd>


<dt id="arg-initparsopt">initparsopt<a class="anchor" aria-label="anchor" href="#arg-initparsopt"></a></dt>
<dd><p>The initial values of the parameters that must be
optimized, they are all positive.</p></dd>


<dt id="arg-idparsopt">idparsopt<a class="anchor" aria-label="anchor" href="#arg-idparsopt"></a></dt>
<dd><p>The ids of the parameters that must be optimized. The ids
are defined as follows: <br><br> id = 1 corresponds to lambda^c
(cladogenesis rate) <br> id = 2 corresponds to mu (extinction rate) <br>
id = 3 corresponds to K (clade-level carrying capacity) <br> id = 4
corresponds to gamma (immigration rate) <br> id = 5 corresponds to lambda^a
(anagenesis rate) <br> id = 6 corresponds to lambda^c (cladogenesis rate)
for an optional subset of the species <br> id = 7 corresponds to mu
(extinction rate) for an optional subset of the species<br> id = 8
corresponds to K (clade-level carrying capacity) for an optional subset of
the species<br> id = 9 corresponds to gamma (immigration rate) for an
optional subset of the species<br> id = 10 corresponds to lambda^a
(anagenesis rate) for an optional subset of the species<br> id = 11
corresponds to p_f (fraction of mainland species that belongs to the second
subset of species.</p></dd>


<dt id="arg-parsfix">parsfix<a class="anchor" aria-label="anchor" href="#arg-parsfix"></a></dt>
<dd><p>The values of the parameters that should not be optimized.</p></dd>


<dt id="arg-idparsfix">idparsfix<a class="anchor" aria-label="anchor" href="#arg-idparsfix"></a></dt>
<dd><p>The ids of the parameters that should not be optimized,
e.g. c(1,3) if lambda^c and K should not be optimized.</p></dd>


<dt id="arg-idparsnoshift">idparsnoshift<a class="anchor" aria-label="anchor" href="#arg-idparsnoshift"></a></dt>
<dd><p>For datatype = 'single' only: The ids of the parameters
that should not be different between two groups of species; This can only
apply to ids 6:10, e.g. idparsnoshift = c(6,7) means that lambda^c and mu
have the same values for both groups.</p></dd>


<dt id="arg-idparsmat">idparsmat<a class="anchor" aria-label="anchor" href="#arg-idparsmat"></a></dt>
<dd><p>For datatype = 'multiple' only: Matrix containing the ids
of the parameters, linking them to initparsopt and parsfix. Per island
system we use the following order: <br><br> * lac = (initial) cladogenesis
rate <br> * mu = extinction rate <br> * K = maximum number of species possible
in the clade <br> * gam = (initial) immigration rate <br> * laa = (initial)
anagenesis rate <br> Example:
<code>idparsmat = rbind(c(1, 2, 3, 4, 5), c(1, 2, 3, 6, 7))</code> has different
rates of immigration and anagenesis for the two islands.</p></dd>


<dt id="arg-res">res<a class="anchor" aria-label="anchor" href="#arg-res"></a></dt>
<dd><p>Sets the maximum number of species for which a probability must
be computed, must be larger than the size of the largest clade.</p></dd>


<dt id="arg-ddmodel">ddmodel<a class="anchor" aria-label="anchor" href="#arg-ddmodel"></a></dt>
<dd><p>Sets the model of diversity-dependence: <br><br> ddmodel = 0 :
no diversity dependence <br> ddmodel = 1 : linear dependence in speciation
rate <br> ddmodel = 11: linear dependence in speciation rate and in
immigration rate <br> ddmodel = 2 : exponential dependence in speciation
rate<br> ddmodel = 21: exponential dependence in speciation rate and in
immigration rate<br></p></dd>


<dt id="arg-cond">cond<a class="anchor" aria-label="anchor" href="#arg-cond"></a></dt>
<dd><p>cond = 0 : conditioning on island age <br> cond = 1 :
conditioning on island age and non-extinction of the island biota <br>.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br></p></dd>


<dt id="arg-island-ontogeny">island_ontogeny<a class="anchor" aria-label="anchor" href="#arg-island-ontogeny"></a></dt>
<dd><p>In <code><a href="DAISIE_sim_time_dep.html">DAISIE_sim_time_dep</a>()</code>,
<code>DAISIE_ML_CS</code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p></dd>


<dt id="arg-eqmodel">eqmodel<a class="anchor" aria-label="anchor" href="#arg-eqmodel"></a></dt>
<dd><p>Sets the equilibrium constraint that can be used during the
likelihood optimization. Only available for datatype = 'single'.<br><br>
eqmodel = 0 : no equilibrium is assumed <br> eqmodel = 13 : near-equilibrium
is assumed on endemics using deterministic equation for endemics and
immigrants. Endemics must be within x_E of the equilibrium value<br> eqmodel
= 15 : near-equilibrium is assumed on endemics and immigrants using
deterministic equation for endemics and immigrants. Endemics must be within
x_E of the equilibrium value, while non-endemics must be within x_I of the
equilibrium value.</p></dd>


<dt id="arg-x-e">x_E<a class="anchor" aria-label="anchor" href="#arg-x-e"></a></dt>
<dd><p>Sets the fraction of the equlibrium endemic diversity above which
the endemics are assumed to be in equilibrium; only active for eqmodel = 13
or 15.</p></dd>


<dt id="arg-x-i">x_I<a class="anchor" aria-label="anchor" href="#arg-x-i"></a></dt>
<dd><p>Sets the fraction of the equlibrium non-endemic diversity above
which the system is assumed to be in equilibrium; only active for eqmodel =
15.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Sets the tolerances in the optimization. Consists of: <br> reltolx
= relative tolerance of parameter values in optimization <br> reltolf =
relative tolerance of function value in optimization <br> abstolx = absolute
tolerance of parameter values in optimization.</p></dd>


<dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>Sets the maximum number of iterations in the optimization.</p></dd>


<dt id="arg-methode">methode<a class="anchor" aria-label="anchor" href="#arg-methode"></a></dt>
<dd><p>Method of the ODE-solver. Supported Boost <code>ODEINT</code>
solvers (steppers) are:
<code>"odeint::runge_kutta_cash_karp54"</code>
<code>"odeint::runge_kutta_fehlberg78"</code>
<code>"odeint::runge_kutta_dopri5"</code>
<code>"odeint::bulirsch_stoer"</code>
without <code>odeint::</code>-prefix, <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></code> method is
assumed. The default method overall is
<code>"lsodes"</code> for <code>DAISIE_ML_CS()</code>
and <code>"ode45"</code> from <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a>()</code> for
<code><a href="DAISIE_ML_IW.html">DAISIE_ML_IW</a>()</code>.</p></dd>


<dt id="arg-optimmethod">optimmethod<a class="anchor" aria-label="anchor" href="#arg-optimmethod"></a></dt>
<dd><p>Method used in likelihood optimization. Default is
`subplex` (see `<a href="https://rdrr.io/pkg/subplex/man/subplex.html" class="external-link">subplex</a>()` for full details).
Alternative is <code>"simplex"</code> which was the method in previous versions.</p></dd>


<dt id="arg-cs-version">CS_version<a class="anchor" aria-label="anchor" href="#arg-cs-version"></a></dt>
<dd><p>a numeric or list. Default is 1 for the standard DAISIE
model, for a relaxed-rate model a list with the following elements:</p><ul><li><p>model: the CS model to run, options are <code>1</code> for single rate
  DAISIE model, <code>2</code> for multi-rate DAISIE, or <code>0</code> for IW test
  model.</p></li>
<li><p>relaxed_par: the parameter to relax (integrate over). Options are
<code>"cladogenesis"</code>, <code>"extinction"</code>, <code>"carrying_capacity"</code>,
<code>"immigration"</code>, or <code>"anagenesis"</code>.</p></li>
</ul></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A numeric vector of length 1, which in simulations and
`DAISIEdataprep()` can be `1` or `0`, where `1` gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: `0` does not print, `1` prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), `2` prints the same as `1 and also the
intermediate output of the parameters and loglikelihood, while `3` the
same as `2` and prints intermediate progress during likelihood computation.</p></dd>


<dt id="arg-tolint">tolint<a class="anchor" aria-label="anchor" href="#arg-tolint"></a></dt>
<dd><p>Vector of two elements containing the absolute and relative
tolerance of the integration.</p></dd>


<dt id="arg-jitter">jitter<a class="anchor" aria-label="anchor" href="#arg-jitter"></a></dt>
<dd><p>Numeric for <code><a href="https://rdrr.io/pkg/DDD/man/optimizer.html" class="external-link">optimizer</a>()</code>. Jitters the
parameters being optimized by the specified amount which should be very
small, e.g. 1e-5. Jitter when <code>link{subplex}{subplex}()</code> produces
incorrect output due to parameter transformation.</p></dd>


<dt id="arg-num-cycles">num_cycles<a class="anchor" aria-label="anchor" href="#arg-num-cycles"></a></dt>
<dd><p>The number of cycles the optimizer will go through.
Default is 1.</p></dd>


<dt id="arg-function-to-optimize">function_to_optimize<a class="anchor" aria-label="anchor" href="#arg-function-to-optimize"></a></dt>
<dd><p>Here one can indicate to use a function
('DAISIE_approx') that approximates the DAISIE likelihood or the default
value 'DAISIE_exact'). The approximate likelihood can for example be used
in case the exact one fails. This is still under development.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The output is a dataframe containing estimated parameters and
maximum loglikelihood.</p>
<dl><dt>lambda_c</dt>
<dd><p>gives the maximum likelihood
estimate of lambda^c, the rate of cladogenesis</p></dd>

<dt>mu</dt>
<dd><p>gives the maximum
likelihood estimate of mu, the extinction rate</p></dd>

<dt>K</dt>
<dd><p>gives the maximum
likelihood estimate of K, the carrying-capacity</p></dd>

<dt>gamma</dt>
<dd><p>gives the maximum likelihood estimate of gamma, the immigration rate</p></dd>

<dt>lambda_a</dt>
<dd><p>gives the maximum likelihood estimate of lambda^a, the rate
of anagenesis</p></dd>

<dt>lambda_c2</dt>
<dd><p>gives the maximum likelihood estimate of lambda^c2,
the rate of cladogenesis for the optional second group of species</p></dd>

<dt>mu2</dt>
<dd><p>gives the maximum likelihood estimate of mu2, the extinction rate for
the optional second group of species</p></dd>

<dt>K2</dt>
<dd><p>gives the maximum likelihood estimate of K2, the carrying-capacity
for the optional second group of species</p></dd>

<dt>gamma2</dt>
<dd><p>gives the maximum likelihood estimate of gamma2, the immigration rate for the optional second
group of species</p></dd>

<dt>lambda_a2</dt>
<dd><p>gives the maximum likelihood estimate of
lambda^a2, the rate of anagenesis for the optional second group of species</p></dd>

<dt>loglik</dt>
<dd><p>gives the maximum loglikelihood</p></dd>

<dt>df</dt>
<dd><p>gives the number of estimated parameters, i.e. degrees of feedom</p></dd>

<dt>conv</dt>
<dd><p>gives a
message on convergence of optimization; conv = 0 means convergence</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852. &lt;doi:10.1111/ele.12461&gt;.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="DAISIE_loglik_CS.html">DAISIE_loglik_all</a></code>,
<code><a href="DAISIE_sim.html">DAISIE_sim_cr</a></code>,
<code><a href="DAISIE_sim_time_dep.html">DAISIE_sim_time_dep</a></code>,
<code><a href="DAISIE_sim_cr_shift.html">DAISIE_sim_cr_shift</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Rampal S. Etienne</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">### When all species have the same rates, and we want to optimize all 5 parameters,</span></span></span>
<span class="r-in"><span><span class="st"># we use:</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">utils::data(Galapagos_datalist)</span></span></span>
<span class="r-in"><span><span class="st">DAISIE_ML(</span></span></span>
<span class="r-in"><span><span class="st">   datalist = Galapagos_datalist,</span></span></span>
<span class="r-in"><span><span class="st">   initparsopt = c(2.5,2.7,20,0.009,1.01),</span></span></span>
<span class="r-in"><span><span class="st">   ddmodel = 11,</span></span></span>
<span class="r-in"><span><span class="st">   idparsopt = 1:5,</span></span></span>
<span class="r-in"><span><span class="st">   parsfix = NULL,</span></span></span>
<span class="r-in"><span><span class="st">   idparsfix = NULL</span></span></span>
<span class="r-in"><span><span class="st">)</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">### When all species have the same rates, and we want to optimize all parameters</span></span></span>
<span class="r-in"><span><span class="st"># except K (which we set equal to Inf), we use:</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">utils::data(Galapagos_datalist)</span></span></span>
<span class="r-in"><span><span class="st">DAISIE_ML(</span></span></span>
<span class="r-in"><span><span class="st">   datalist = Galapagos_datalist,</span></span></span>
<span class="r-in"><span><span class="st">   initparsopt = c(2.5,2.7,0.009,1.01),</span></span></span>
<span class="r-in"><span><span class="st">   idparsopt = c(1,2,4,5),</span></span></span>
<span class="r-in"><span><span class="st">   parsfix = Inf,</span></span></span>
<span class="r-in"><span><span class="st">   idparsfix = 3</span></span></span>
<span class="r-in"><span><span class="st">   )</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">### When all species have the same rates except that the finches have a different</span></span></span>
<span class="r-in"><span><span class="st"># rate of cladogenesis, and we want to optimize all parameters except K (which we</span></span></span>
<span class="r-in"><span><span class="st"># set equal to Inf), fixing the proportion of finch-type species at 0.163, we use:</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">utils::data(Galapagos_datalist_2types)</span></span></span>
<span class="r-in"><span><span class="st">DAISIE_ML(</span></span></span>
<span class="r-in"><span><span class="st">   datalist = Galapagos_datalist_2types,</span></span></span>
<span class="r-in"><span><span class="st">   initparsopt = c(0.38,0.55,0.004,1.1,2.28),</span></span></span>
<span class="r-in"><span><span class="st">   idparsopt = c(1,2,4,5,6),</span></span></span>
<span class="r-in"><span><span class="st">   parsfix = c(Inf,Inf,0.163),</span></span></span>
<span class="r-in"><span><span class="st">   idparsfix = c(3,8,11),</span></span></span>
<span class="r-in"><span><span class="st">   idparsnoshift = c(7,9,10)</span></span></span>
<span class="r-in"><span><span class="st">   )</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">### When all species have the same rates except that the finches have a different</span></span></span>
<span class="r-in"><span><span class="st"># rate of cladogenesis, extinction and a different K, and we want to optimize all</span></span></span>
<span class="r-in"><span><span class="st"># parameters, fixing the proportion of finch-type species at 0.163, we use:</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">utils::data(Galapagos_datalist_2types)</span></span></span>
<span class="r-in"><span><span class="st">DAISIE_ML(</span></span></span>
<span class="r-in"><span><span class="st">   datalist = Galapagos_datalist_2types,</span></span></span>
<span class="r-in"><span><span class="st">   ddmodel = 11,</span></span></span>
<span class="r-in"><span><span class="st">   initparsopt = c(0.19,0.09,0.002,0.87,20,8.9,15),</span></span></span>
<span class="r-in"><span><span class="st">   idparsopt = c(1,2,4,5,6,7,8),</span></span></span>
<span class="r-in"><span><span class="st">   parsfix = c(Inf,0.163),</span></span></span>
<span class="r-in"><span><span class="st">   idparsfix = c(3,11),</span></span></span>
<span class="r-in"><span><span class="st">   idparsnoshift = c(9,10)</span></span></span>
<span class="r-in"><span><span class="st">   )</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">### When all species have the same rates except that the finches have a different</span></span></span>
<span class="r-in"><span><span class="st"># rate of extinction, and we want to optimize all parameters except K (which we</span></span></span>
<span class="r-in"><span><span class="st"># set equal to Inf), and we also# want to estimate the fraction of finch species</span></span></span>
<span class="r-in"><span><span class="st"># in the mainland pool. we use:</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">utils::data(Galapagos_datalist_2types)</span></span></span>
<span class="r-in"><span><span class="st">DAISIE_ML(</span></span></span>
<span class="r-in"><span><span class="st">   datalist = Galapagos_datalist_2types,</span></span></span>
<span class="r-in"><span><span class="st">   initparsopt = c(2.48,2.7,0.009,1.01,2.25,0.163),</span></span></span>
<span class="r-in"><span><span class="st">   idparsopt = c(1,2,4,5,7,11),</span></span></span>
<span class="r-in"><span><span class="st">   parsfix = c(Inf,Inf),</span></span></span>
<span class="r-in"><span><span class="st">   idparsfix = c(3,8),</span></span></span>
<span class="r-in"><span><span class="st">   idparsnoshift = c(6,9,10)</span></span></span>
<span class="r-in"><span><span class="st">   )</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">### When we have two islands with the same rates except for immigration and anagenesis rate,</span></span></span>
<span class="r-in"><span><span class="st"># and we want to optimize all parameters, we use:</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">utils::data(Galapagos_datalist)</span></span></span>
<span class="r-in"><span><span class="st">DAISIE_ML(</span></span></span>
<span class="r-in"><span><span class="st">   datalist = list(Galapagos_datalist,Galapagos_datalist),</span></span></span>
<span class="r-in"><span><span class="st">   datatype = 'multiple',</span></span></span>
<span class="r-in"><span><span class="st">   initparsopt = c(2.5,2.7,20,0.009,1.01,0.009,1.01),</span></span></span>
<span class="r-in"><span><span class="st">   idparsmat = rbind(1:5,c(1:3,6,7)),</span></span></span>
<span class="r-in"><span><span class="st">   idparsopt = 1:7,</span></span></span>
<span class="r-in"><span><span class="st">   parsfix = NULL,</span></span></span>
<span class="r-in"><span><span class="st">   idparsfix = NULL</span></span></span>
<span class="r-in"><span><span class="st">)</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">### When we consider the four Macaronesia archipelagoes and set all parameters the same</span></span></span>
<span class="r-in"><span><span class="st"># except for rates of cladogenesis, extinction and immigration for Canary Islands,</span></span></span>
<span class="r-in"><span><span class="st"># rate of cladogenesis is fixed to 0 for the other archipelagoes,</span></span></span>
<span class="r-in"><span><span class="st"># diversity-dependence is assumed to be absent</span></span></span>
<span class="r-in"><span><span class="st"># and we want to optimize all parameters, we use:</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">utils::data(Macaronesia_datalist)</span></span></span>
<span class="r-in"><span><span class="st">DAISIE_ML(</span></span></span>
<span class="r-in"><span><span class="st">   datalist = Macaronesia_datalist,</span></span></span>
<span class="r-in"><span><span class="st">   datatype = 'multiple',</span></span></span>
<span class="r-in"><span><span class="st">   initparsopt = c(1.053151832,0.052148979,0.512939011,0.133766934,0.152763179),</span></span></span>
<span class="r-in"><span><span class="st">   idparsmat = rbind(1:5,c(6,2,3,7,5),1:5,1:5),</span></span></span>
<span class="r-in"><span><span class="st">   idparsopt = c(2,4,5,6,7),</span></span></span>
<span class="r-in"><span><span class="st">   parsfix = c(0,Inf),</span></span></span>
<span class="r-in"><span><span class="st">   idparsfix = c(1,3)</span></span></span>
<span class="r-in"><span><span class="st">)</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ### When all species have the same rates, and we want to optimize all 5 parameters,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # we use:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> utils::data(Galapagos_datalist)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DAISIE_ML(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    datalist = Galapagos_datalist,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    initparsopt = c(2.5,2.7,20,0.009,1.01),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ddmodel = 11,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsopt = 1:5,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    parsfix = NULL,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsfix = NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ### When all species have the same rates, and we want to optimize all parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # except K (which we set equal to Inf), we use:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> utils::data(Galapagos_datalist)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DAISIE_ML(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    datalist = Galapagos_datalist,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    initparsopt = c(2.5,2.7,0.009,1.01),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsopt = c(1,2,4,5),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    parsfix = Inf,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsfix = 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ### When all species have the same rates except that the finches have a different</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # rate of cladogenesis, and we want to optimize all parameters except K (which we</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # set equal to Inf), fixing the proportion of finch-type species at 0.163, we use:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> utils::data(Galapagos_datalist_2types)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DAISIE_ML(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    datalist = Galapagos_datalist_2types,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    initparsopt = c(0.38,0.55,0.004,1.1,2.28),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsopt = c(1,2,4,5,6),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    parsfix = c(Inf,Inf,0.163),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsfix = c(3,8,11),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsnoshift = c(7,9,10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ### When all species have the same rates except that the finches have a different</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # rate of cladogenesis, extinction and a different K, and we want to optimize all</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # parameters, fixing the proportion of finch-type species at 0.163, we use:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> utils::data(Galapagos_datalist_2types)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DAISIE_ML(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    datalist = Galapagos_datalist_2types,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ddmodel = 11,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    initparsopt = c(0.19,0.09,0.002,0.87,20,8.9,15),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsopt = c(1,2,4,5,6,7,8),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    parsfix = c(Inf,0.163),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsfix = c(3,11),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsnoshift = c(9,10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ### When all species have the same rates except that the finches have a different</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # rate of extinction, and we want to optimize all parameters except K (which we</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # set equal to Inf), and we also# want to estimate the fraction of finch species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # in the mainland pool. we use:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> utils::data(Galapagos_datalist_2types)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DAISIE_ML(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    datalist = Galapagos_datalist_2types,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    initparsopt = c(2.48,2.7,0.009,1.01,2.25,0.163),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsopt = c(1,2,4,5,7,11),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    parsfix = c(Inf,Inf),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsfix = c(3,8),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsnoshift = c(6,9,10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ### When we have two islands with the same rates except for immigration and anagenesis rate,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # and we want to optimize all parameters, we use:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> utils::data(Galapagos_datalist)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DAISIE_ML(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    datalist = list(Galapagos_datalist,Galapagos_datalist),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    datatype = 'multiple',</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    initparsopt = c(2.5,2.7,20,0.009,1.01,0.009,1.01),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsmat = rbind(1:5,c(1:3,6,7)),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsopt = 1:7,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    parsfix = NULL,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsfix = NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ### When we consider the four Macaronesia archipelagoes and set all parameters the same</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # except for rates of cladogenesis, extinction and immigration for Canary Islands,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # rate of cladogenesis is fixed to 0 for the other archipelagoes,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # diversity-dependence is assumed to be absent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # and we want to optimize all parameters, we use:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> utils::data(Macaronesia_datalist)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DAISIE_ML(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    datalist = Macaronesia_datalist,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    datatype = 'multiple',</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    initparsopt = c(1.053151832,0.052148979,0.512939011,0.133766934,0.152763179),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsmat = rbind(1:5,c(6,2,3,7,5),1:5,1:5),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsopt = c(2,4,5,6,7),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    parsfix = c(0,Inf),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    idparsfix = c(1,3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rampal S. Etienne, Luis Valente, Albert B. Phillimore, Bart Haegeman, Joshua W. Lambert, Pedro Santos Neves, Shu Xie, Richèl J.C. Bilderbeek, Hanno Hildenbrandt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

