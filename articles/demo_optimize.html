<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DAISIE">
<title>Demo optimizing parameters • DAISIE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Demo optimizing parameters">
<meta property="og:description" content="DAISIE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DAISIE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/demo_CSvsIW.html">Demo: Fitting clade-specific and island-wide diversity-dependence models in DAISIE</a>
    <a class="dropdown-item" href="../articles/demo_optimize.html">Demo optimizing parameters</a>
    <a class="dropdown-item" href="../articles/demo_sim.html">Demo simulating islands</a>
    <a class="dropdown-item" href="../articles/stac_key.html">DAISIE `stac` values</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rsetienne/DAISIE/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Demo optimizing parameters</h1>
                        <h4 data-toc-skip class="author">Luis M.
Valente, Albert B. Phillimore, Rampal S. Etienne</h4>
            
            <h4 data-toc-skip class="date">19 May 2015</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rsetienne/DAISIE/blob/HEAD/vignettes/demo_optimize.Rmd" class="external-link"><code>vignettes/demo_optimize.Rmd</code></a></small>
      <div class="d-none name"><code>demo_optimize.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="daisie-dynamic-assembly-of-island-biotas-through-speciation-immigration-and-extinction">DAISIE – Dynamic Assembly of Island biotas through Speciation,
Immigration and Extinction<a class="anchor" aria-label="anchor" href="#daisie-dynamic-assembly-of-island-biotas-through-speciation-immigration-and-extinction"></a>
</h2>
<p>Citation: Valente LM, Phillimore AB, Etienne RS (2015) Equilibrium
and non- equilibrium dynamics simultaneously operate in the Galápagos
islands. Ecology Letters, In press.</p>
<div class="section level3">
<h3 id="loading-data-table">Loading data table<a class="anchor" aria-label="anchor" href="#loading-data-table"></a>
</h3>
<p>To load the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rsetienne/DAISIE" class="external-link">DAISIE</a></span><span class="op">)</span></span></code></pre></div>
<p>The raw dataset is inputted as a table. The Galápagos dataset table
can be visualized with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Galapagos_datatable</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">Galapagos_datatable</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="8%">
<col width="12%">
<col width="10%">
<col width="68%">
</colgroup>
<thead><tr class="header">
<th align="left">Clade_name</th>
<th align="left">Status</th>
<th align="right">Missing_species</th>
<th align="left">Branching_times</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Coccyzus</td>
<td align="left">Non_endemic_MaxAge</td>
<td align="right">0</td>
<td align="left">7.456</td>
</tr>
<tr class="even">
<td align="left">Dendroica</td>
<td align="left">Non_endemic</td>
<td align="right">0</td>
<td align="left">0.34</td>
</tr>
<tr class="odd">
<td align="left">Finches</td>
<td align="left">Endemic</td>
<td align="right">0</td>
<td align="left">3.0282,1.3227,0.8223,0.4286,0.3462,0.245,0.0808,0.0527,0.0327,0.0221,0.118,0.0756,0.0525,0.0322,0.0118</td>
</tr>
<tr class="even">
<td align="left">Mimus</td>
<td align="left">Endemic</td>
<td align="right">0</td>
<td align="left">3.958,3.422,2.884,0.459</td>
</tr>
<tr class="odd">
<td align="left">Myiarchus</td>
<td align="left">Endemic</td>
<td align="right">0</td>
<td align="left">0.855</td>
</tr>
<tr class="even">
<td align="left">Progne</td>
<td align="left">Endemic</td>
<td align="right">0</td>
<td align="left">0.086</td>
</tr>
<tr class="odd">
<td align="left">Pyrocephalus</td>
<td align="left">Non_endemic_MaxAge</td>
<td align="right">0</td>
<td align="left">10.285</td>
</tr>
<tr class="even">
<td align="left">Zenaida</td>
<td align="left">Endemic</td>
<td align="right">0</td>
<td align="left">3.51</td>
</tr>
</tbody>
</table>
<p>Each row in the table represents an independent colonisation event.
The table has four columns:</p>
<ul>
<li>
<code>Clade_name</code>: name of the independent colonization
event.</li>
<li>
<code>Status</code>: One of the following categories:
<ul>
<li>
<code>Endemic</code>: applicable for both anagenetic species and
radiations.</li>
<li>
<code>Non_endemic</code>: If the taxon is not endemic to the island,
and the age of colonisation is based on a phylogeny where both island
and non-island populations of the species have been sampled.</li>
<li>
<code>Non_endemic_MaxAge</code>: If the taxon is not endemic to the
island, and only an upper bound to the time of colonisation of the
island is known. This applies if individuals from the island population
of the species have not been sampled, but an age of the species is
known.</li>
<li>
<code>Endemic&amp;Non_Endemic</code>: When an endemic clade is
present and the mainland ancestor has re-colonized. For remote islands
this is expected to be very rare.</li>
</ul>
</li>
<li>
<code>Missing_species</code>: Number of island species that were not
sampled for a particular clade (only applicable for radiations).</li>
<li>
<code>Branching_times</code> – This should be the stem age of the
population/species in the case of <code>Non-endemic</code>,
<code>Non-endemic_MaxAge</code> and <code>Endemic</code> anagenetic
species. For cladogenetic species these should be branching times of the
radiation including the stem age of the radiation. Note – if there are
species within the radiation that are not found on the island
(e.g. back-colonisation) the branching times of these species should be
excluded, as the mainland species pool is treated as static.</li>
</ul>
<p>The same data can also be visualized:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DAISIE</span><span class="fu">::</span><span class="fu"><a href="../reference/DAISIE_plot_island.html">DAISIE_plot_island</a></span><span class="op">(</span><span class="va">Galapagos_datatable</span>, island_age <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Colonisation time of 7.456 for Coccyzus is older than island age</span></span>
<span><span class="co">#&gt; Colonisation time of 10.285 for Pyrocephalus is older than island age</span></span></code></pre></div>
<p><img src="demo_optimize_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="formatting-table-to-run-in-daisie">Formatting table to run in DAISIE<a class="anchor" aria-label="anchor" href="#formatting-table-to-run-in-daisie"></a>
</h3>
<p>Before running analyses, the datatable needs to be converted to a
DAISIE datalist format using the function DAISIE_dataprep.</p>
<p>We will prepare two different datalists based on the Galápagos
datatable. In the 1st datalist we will treat all taxa as equivalent. We
will specify an island age of four million years (island_age=4) and a
mainland pool size of 1000 (M=1000).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Galapagos_datatable</span><span class="op">)</span> </span>
<span>      </span>
<span><span class="va">Galapagos_datalist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DAISIE_dataprep.html">DAISIE_dataprep</a></span><span class="op">(</span> </span>
<span>  datatable <span class="op">=</span> <span class="va">Galapagos_datatable</span>, </span>
<span>  island_age <span class="op">=</span> <span class="fl">4</span>, </span>
<span>  M <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Colonisation time of 7.456 for Coccyzus is older than island age</span></span>
<span><span class="co">#&gt; Colonisation time of 10.285 for Pyrocephalus is older than island age</span></span></code></pre></div>
<p>In the 2nd datalist we will allow for the Darwin’s finches to form a
separate group for which rates can be decoupled from those governing the
macroevolutionary process in all other clades (number_clade_types=2 and
list_type2_clades = “Finches”). We will set the proportion of Darwin’s
finch type species in the mainland pool to be 0.163.
(prop_type2_pool=0.163). If prop_type2_pool is not specified then by
default it is given the value of the proportion of the Galapagos
lineages that Darwin’s finches represent (1/8=0.125 in this case).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Galapagos_datatable</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">Galapagos_datalist_2types</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DAISIE_dataprep.html">DAISIE_dataprep</a></span><span class="op">(</span> </span>
<span>  datatable <span class="op">=</span> <span class="va">Galapagos_datatable</span>, </span>
<span>  island_age <span class="op">=</span> <span class="fl">4</span>, </span>
<span>  M <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>  number_clade_types <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  list_type2_clades <span class="op">=</span> <span class="st">"Finches"</span>, </span>
<span>  prop_type2_pool <span class="op">=</span> <span class="fl">0.163</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Colonisation time of 7.456 for Coccyzus is older than island age</span></span>
<span><span class="co">#&gt; Colonisation time of 10.285 for Pyrocephalus is older than island age</span></span></code></pre></div>
<p>The objects <code>Galapagos_datalist</code> and
<code>Galapagos_datalist_2types</code> can now be run directly in
<code>DAISIE</code> functions.</p>
</div>
<div class="section level3">
<h3 id="optimizing-parameters-using-maximum-likelihood">Optimizing parameters using maximum likelihood<a class="anchor" aria-label="anchor" href="#optimizing-parameters-using-maximum-likelihood"></a>
</h3>
<p>The function that conducts maximum likelihood optimization of DAISIE
model parameters is called <code>DAISIE_ML</code>.</p>
<p>Different models can be specified using ddmodel option in
<code>DAISIE_ML</code>:</p>
<ul>
<li>
<code>ddmodel = 0</code> : no diversity-dependence</li>
<li>
<code>ddmodel = 1</code> : linear diversity-dependence in speciation
rate</li>
<li>
<code>ddmodel = 11</code>: linear diversity-dependence in speciation
and immigration rate</li>
<li>
<code>ddmodel = 2</code> : exponential diversity-dependence in
speciation rate</li>
<li>
<code>ddmodel = 21</code>: exponential diversity-dependence in
speciation and immigration rate</li>
</ul>
<p>Different types of parameters can be optimized or fixed. The
parameters are given in the following order: (1) cladogenesis rate, (2)
extinction rate, (3) K’ or carrying capacity (maximum number of species
that a clade can attain within the island), (4) colonisation rate, and
(5) anagenesis rate.</p>
<p>The identities of the parameters to be optimized or fixed are
specified with <code>idparsopt</code> and <code>idparsfix</code> within
the DAISIE_ML function. For example, to optimize all parameters we set
<code>idparsopt=1:5</code> and <code>idparsfix=NULL</code>. To optimize
all parameters but fix the rate of extinction, we set
<code>idparsopt=c(1,3,4,5)</code> and <code>idparsfix=2</code>. To
optimize all parameters except cladogenesis and anagenesis we set
<code>idparsopt=c(2,3,4)</code> and <code>idparsfix=c(1,5)</code>.</p>
<p>The values of the parameters to be used as initial values for the
optimization are specified with <code>initparsopt</code>, and the values
to be fixed are specified with <code>parsfix.</code> For example, if we
want to optimize all parameters with a starting value of 2 we set
<code>initparsopt=c(2,2,2,2,2)</code> and <code>parsfix=NULL</code>. If
we want all starting rates to be 0.1, but K’ to be fixed at 20, we use
<code>initparsopt=c(0.1,0.1,0.1,0.1)</code> and
<code>parsfix=20</code>.</p>
<p>When running your own data, we strongly recommend that you test
multiple initial starting parameters for each model, particularly when
optimizing models with multiple free parameters, as there is a high risk
of being trapped in local likelihood sub-optima. We also suggest running
two rounds of optimization using the optimized parameter set of the 1st
round as the initial starting values for the 2nd round. Also note that
the initial starting values in the examples of this tutorial may not be
appropriate for your data.</p>
<div class="section level4">
<h4 id="example-1-optimizing-all-parameters-with-diversity-dependence-in-speciation-and-colonisation">Example 1: Optimizing all parameters, with diversity-dependence in
speciation and colonisation<a class="anchor" aria-label="anchor" href="#example-1-optimizing-all-parameters-with-diversity-dependence-in-speciation-and-colonisation"></a>
</h4>
<p>We will now optimize all five parameters for a datalist where all
clades share the same parameters. We will set the model with linear
diversity-dependence in speciation rate and in immigration rate using
ddmodel=11. We will set an initial rate of cladogenesis of 2.5, an
initial rate of extinction of 2.7, an initial K’ value of 20, an initial
rate of colonisation of 0.009 and an initial rate of anagenesis of 1.01
(<code>initparsopt = c(2.5,2.7,20,0.009,1.01)</code>). We will optimize
all 5 parameters (<code>idparsopt = 1:5</code>) and we will fix no
parameters (<code>parsfix = NULL</code>,
<code>idparsfix = NULL</code>).</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Galapagos_datalist</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="../reference/DAISIE_ML.html">DAISIE_ML</a></span><span class="op">(</span> </span>
<span>  datalist <span class="op">=</span> <span class="va">Galapagos_datalist</span>, </span>
<span>  initparsopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>,<span class="fl">2.7</span>,<span class="fl">20</span>,<span class="fl">0.009</span>,<span class="fl">1.01</span><span class="op">)</span>, </span>
<span>  ddmodel <span class="op">=</span> <span class="fl">11</span>, </span>
<span>  idparsopt <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, </span>
<span>  parsfix <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  idparsfix <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span> </span></code></pre>
<p>This will take several minutes to run. The parameters optimized and
fixed as well as the loglikelihood of the initial starting parameters we
have set are shown at the top of the screen output of DAISIE_ML. Once
the optimization is completed, the program will output the maximum
likelihood parameter estimates and the maximum loglikelihood value. For
a given dataset, the likelihood of different DAISIE models can be
compared with information criteria such as BIC and AIC.</p>
</div>
<div class="section level4">
<h4 id="example-2-optimizing-model-without-diversity-dependence">Example 2: Optimizing model without diversity-dependence<a class="anchor" aria-label="anchor" href="#example-2-optimizing-model-without-diversity-dependence"></a>
</h4>
<p>To optimize the parameters of a model with no diversity-dependence,
we use the default model (ddmodel=0), and fix the parameter number 3
which corresponds to K’ to infinity (Inf).</p>
<pre><code><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Galapagos_datalist</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="../reference/DAISIE_ML.html">DAISIE_ML</a></span><span class="op">(</span> </span>
<span>  datalist <span class="op">=</span> <span class="va">Galapagos_datalist</span>, </span>
<span>  initparsopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>,<span class="fl">2.7</span>,<span class="fl">0.009</span>,<span class="fl">1.01</span><span class="op">)</span>, </span>
<span>  idparsopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>, </span>
<span>  parsfix <span class="op">=</span> <span class="cn">Inf</span>, </span>
<span>  idparsfix <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span> </span></code></pre>
</div>
<div class="section level4">
<h4 id="example-3-optimizing-model-with-no-diversity-dependence-and-no-anagenesis">Example 3: Optimizing model with no diversity-dependence and no
anagenesis<a class="anchor" aria-label="anchor" href="#example-3-optimizing-model-with-no-diversity-dependence-and-no-anagenesis"></a>
</h4>
<p>To optimize the parameters of a model with no diversity-dependence
and no anagenesis, we use the default model (ddmodel=0), and fix
parameters number 3 and 5, which correspond, respectively to K’ and rate
of anagenesis.</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Galapagos_datalist</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/DAISIE_ML.html">DAISIE_ML</a></span><span class="op">(</span> </span>
<span>  datalist<span class="op">=</span><span class="va">Galapagos_datalist</span>, </span>
<span>  initparsopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>,<span class="fl">2.7</span>,<span class="fl">0.009</span><span class="op">)</span>, </span>
<span>  idparsopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>  parsfix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>,<span class="fl">0</span><span class="op">)</span>, </span>
<span>  idparsfix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span> </span></code></pre>
</div>
<div class="section level4">
<h4 id="example-4-optimizing-all-parameters-but-allowing-darwins-finches-to-have-a-separate-rate-of-cladogenesis-">Example 4: Optimizing all parameters, but allowing Darwin’s finches
to have a separate rate of cladogenesis.<a class="anchor" aria-label="anchor" href="#example-4-optimizing-all-parameters-but-allowing-darwins-finches-to-have-a-separate-rate-of-cladogenesis-"></a>
</h4>
<p>For this example we will use the datalist with Darwin’s finches
specified to be of a separate type: Galapagos_datalist_2types.</p>
<p>If two types of species are considered, then the parameters of the
second type of species are in the same order as the first set of
parameters, but start at number 6: (6) cladogenesis rate of type 2
species, (7) extinction rate of type 2 species, (8) K’ of type 2
species, (9) colonisation rate of type 2 species, and (10) anagenesis
rate of type 2 species. There is also an additional parameter when 2
types of species are considered: the proportion of species of type 2 in
the mainland pool. This is parameter number 11.</p>
<p>Here we will optimize all parameters, but allow the finches to have a
separate rate of cladogenesis. We will fix the proportion of type 2
species in the mainland pool at 0.163 (therefore fixing parameter 11
with idparsfix=11 and parsfix=0.163). Note that because we are only
allowing the rate of cladogenesis of Darwin’s finches to vary from the
background rate, we need to specify that the other rates for Darwin’s
finches remain the same as the background – using idparsnoshift =
c(7,8,9,10)).</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Galapagos_datalist_2types</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="../reference/DAISIE_ML.html">DAISIE_ML</a></span><span class="op">(</span> </span>
<span>  ddmodel<span class="op">=</span><span class="fl">11</span>, </span>
<span>  datalist<span class="op">=</span><span class="va">Galapagos_datalist_2types</span>, </span>
<span>  initparsopt<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.38</span>,<span class="fl">0.55</span>,<span class="fl">20</span>,<span class="fl">0.004</span>,<span class="fl">1.1</span>,<span class="fl">2.28</span><span class="op">)</span>, </span>
<span>  idparsopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>, </span>
<span>  parsfix <span class="op">=</span> <span class="fl">0.163</span>, </span>
<span>  idparsfix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span>, </span>
<span>  idparsnoshift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span> </span></code></pre>
</div>
<div class="section level4">
<h4 id="example-5-optimizing-a-model-with-no-diversity-dependence-but-allowing-darwins-finches-to-have-a-separate-rate-of-cladogenesis-and-extinction-">Example 5: Optimizing a model with no diversity-dependence, but
allowing Darwin’s finches to have a separate rate of cladogenesis and
extinction.<a class="anchor" aria-label="anchor" href="#example-5-optimizing-a-model-with-no-diversity-dependence-but-allowing-darwins-finches-to-have-a-separate-rate-of-cladogenesis-and-extinction-"></a>
</h4>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Galapagos_datalist_2types</span><span class="op">)</span> </span>
<span> </span>
<span><span class="fu"><a href="../reference/DAISIE_ML.html">DAISIE_ML</a></span><span class="op">(</span> </span>
<span>  ddmodel<span class="op">=</span><span class="fl">0</span>, </span>
<span>  datalist<span class="op">=</span><span class="va">Galapagos_datalist_2types</span>, </span>
<span>  initparsopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.38</span>,<span class="fl">0.55</span>,<span class="fl">0.004</span>,<span class="fl">1.1</span>,<span class="fl">2.28</span>,<span class="fl">2</span><span class="op">)</span>, </span>
<span>  idparsopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span>, </span>
<span>  parsfix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>,<span class="fl">0.163</span><span class="op">)</span>, </span>
<span>  idparsfix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">11</span><span class="op">)</span>, </span>
<span>  idparsnoshift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span> </span></code></pre>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rampal S. Etienne, Luis Valente, Albert B. Phillimore, Bart Haegeman, Joshua W. Lambert, Pedro Santos Neves, Shu Xie, Richèl J.C. Bilderbeek, Hanno Hildenbrandt.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
