<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Demo simulating islands • DAISIE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Demo simulating islands">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DAISIE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.4.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/demo_CSvsIW.html">Demo: Fitting clade-specific and island-wide diversity-dependence models in DAISIE</a></li>
    <li><a class="dropdown-item" href="../articles/demo_optimize.html">Demo optimizing parameters</a></li>
    <li><a class="dropdown-item" href="../articles/demo_sim.html">Demo simulating islands</a></li>
    <li><a class="dropdown-item" href="../articles/stac_key.html">DAISIE `stac` values</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rsetienne/DAISIE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Demo simulating islands</h1>
                        <h4 data-toc-skip class="author">Luis M.
Valente, Albert B. Phillimore, Rampal S. Etienne</h4>
            
            <h4 data-toc-skip class="date">19 May 2015</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rsetienne/DAISIE/blob/master/vignettes/demo_sim.Rmd" class="external-link"><code>vignettes/demo_sim.Rmd</code></a></small>
      <div class="d-none name"><code>demo_sim.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="daisie-dynamic-assembly-of-island-biotas-through-speciation-immigration-and-extinction">DAISIE – Dynamic Assembly of Island biotas through Speciation,
Immigration and Extinction<a class="anchor" aria-label="anchor" href="#daisie-dynamic-assembly-of-island-biotas-through-speciation-immigration-and-extinction"></a>
</h2>
<p>Citation: Valente LM, Phillimore AB, Etienne RS (2015) Equilibrium
and non- equilibrium dynamics simultaneously operate in the Galápagos
islands. Ecology Letters, 18(8), 844-852. <a href="https://doi.org/10.1111/ele.12461" class="external-link uri">https://doi.org/10.1111/ele.12461</a>.</p>
<div class="section level3">
<h3 id="loading">Loading<a class="anchor" aria-label="anchor" href="#loading"></a>
</h3>
<p>To load the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rsetienne/DAISIE" class="external-link">DAISIE</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulating-islands">Simulating islands<a class="anchor" aria-label="anchor" href="#simulating-islands"></a>
</h3>
<p>The function <code>DAISIE_sim</code> allows simulation of DAISIE
models and plots the results. The user specifies the parameters to be
simulated, the number of replicates, the length of the simulation
(typically the island age), and the number of species in the mainland
pool.</p>
<p>When the plot_sims option is set to the default (TRUE) the function
will produce a species- through-time plot showing the accumulation of
total, endemic and non-endemic species through time, as well as
confidence intervals for the total number of species.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_mainland_species</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">island_age</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></code></pre></div>
<p>To shorten the run-time of this vignette, reduce the number of
<code>n_replicates</code>. For increased accuracy, increase this
number.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_replicates</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></code></pre></div>
<div class="section level4">
<h4 id="example-5-1-simulating-10-islands-with-no-diversity-dependence-all-species-sharing-the-same-parameters-and-plotting-the-results">Example 5.1 – Simulating 10 islands with no diversity-dependence,
all species sharing the same parameters, and plotting the results<a class="anchor" aria-label="anchor" href="#example-5-1-simulating-10-islands-with-no-diversity-dependence-all-species-sharing-the-same-parameters-and-plotting-the-results"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clado_rate</span> <span class="op">&lt;-</span> <span class="fl">2.550687345</span> <span class="co"># cladogenesis rate</span></span>
<span><span class="va">ext_rate</span> <span class="op">&lt;-</span> <span class="fl">2.683454548</span> <span class="co"># extinction rate</span></span>
<span><span class="va">clade_carr_cap</span> <span class="op">&lt;-</span> <span class="cn">Inf</span> <span class="co"># clade-level carrying capacity</span></span>
<span><span class="va">imm_rate</span> <span class="op">&lt;-</span> <span class="fl">0.00933207</span> <span class="co"># immigration rate</span></span>
<span><span class="va">ana_rate</span> <span class="op">&lt;-</span> <span class="fl">1.010073119</span> <span class="co"># anagenesis rate</span></span>
<span></span>
<span><span class="va">island_replicates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DAISIE_sim.html">DAISIE_sim_cr</a></span><span class="op">(</span> </span>
<span>  time <span class="op">=</span> <span class="va">island_age</span>,</span>
<span>  M <span class="op">=</span> <span class="va">n_mainland_species</span>, </span>
<span>  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">clado_rate</span>, <span class="va">ext_rate</span>, <span class="va">clade_carr_cap</span>, <span class="va">imm_rate</span>, <span class="va">ana_rate</span><span class="op">)</span>,</span>
<span>  replicates <span class="op">=</span> <span class="va">n_replicates</span>,</span>
<span>  plot_sims <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DAISIE_plot_sims.html">DAISIE_plot_sims</a></span><span class="op">(</span>island_replicates <span class="op">=</span> <span class="va">island_replicates</span><span class="op">)</span></span></code></pre></div>
<p><img src="demo_sim_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>The object <code>island_replicates</code> contains the results of the
simulation in DAISIE format. 10 islands are stored in the object, and
each island replicate can be viewed separately. For example, type
<code>island_replicates[[1]]</code> to view the first replicate.</p>
<p>The element of the list relating to each island contains a table with
the number of species through time, as well as branching time
information for each independent colonisation event extant at the end of
the simulation.</p>
</div>
<div class="section level4">
<h4 id="example-5-2-simulating-10-islands-with-diversity-dependence-k10-all-species-sharing-the-same-parameters-and-plotting-the-results">Example 5.2 – Simulating 10 islands with diversity-dependence
(K’=10), all species sharing the same parameters, and plotting the
results<a class="anchor" aria-label="anchor" href="#example-5-2-simulating-10-islands-with-diversity-dependence-k10-all-species-sharing-the-same-parameters-and-plotting-the-results"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clado_rate</span> <span class="op">&lt;-</span> <span class="fl">2.550687345</span> <span class="co"># cladogenesis rate</span></span>
<span><span class="va">ext_rate</span> <span class="op">&lt;-</span> <span class="fl">2.683454548</span> <span class="co"># extinction rate</span></span>
<span><span class="va">clade_carr_cap</span> <span class="op">&lt;-</span> <span class="fl">10.0</span>  <span class="co"># clade-level carrying capacity</span></span>
<span><span class="va">imm_rate</span> <span class="op">&lt;-</span> <span class="fl">0.00933207</span> <span class="co"># immigration rate</span></span>
<span><span class="va">ana_rate</span> <span class="op">&lt;-</span> <span class="fl">1.010073119</span> <span class="co"># anagenesis rate</span></span>
<span></span>
<span><span class="va">island_replicates_K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DAISIE_sim.html">DAISIE_sim_cr</a></span><span class="op">(</span> </span>
<span>  time <span class="op">=</span> <span class="va">island_age</span>, </span>
<span>  M <span class="op">=</span> <span class="va">n_mainland_species</span>, </span>
<span>  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">clado_rate</span>, <span class="va">ext_rate</span>, <span class="va">clade_carr_cap</span>, <span class="va">imm_rate</span>, <span class="va">ana_rate</span><span class="op">)</span>,</span>
<span>  replicates <span class="op">=</span> <span class="va">n_replicates</span>,</span>
<span>  plot_sims <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/DAISIE_plot_sims.html">DAISIE_plot_sims</a></span><span class="op">(</span><span class="va">island_replicates_K</span><span class="op">)</span></span></code></pre></div>
<p><img src="demo_sim_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="example-5-3-simulating-10-islands-allowing-darwins-finches-to-have-a-higher-rate-of-cladogenesis">Example 5.3 – Simulating 10 islands allowing Darwin’s finches to
have a higher rate of cladogenesis:<a class="anchor" aria-label="anchor" href="#example-5-3-simulating-10-islands-allowing-darwins-finches-to-have-a-higher-rate-of-cladogenesis"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clado_rate_1</span> <span class="op">&lt;-</span> <span class="fl">0.38</span> <span class="co"># cladogenesis rate</span></span>
<span><span class="va">ext_rate_1</span> <span class="op">&lt;-</span> <span class="fl">0.55</span> <span class="co"># extinction rate</span></span>
<span><span class="va">clade_carr_cap_1</span> <span class="op">&lt;-</span> <span class="cn">Inf</span>  <span class="co"># clade-level carrying capacity</span></span>
<span><span class="va">imm_rate_1</span> <span class="op">&lt;-</span> <span class="fl">0.04</span> <span class="co"># immigration rate</span></span>
<span><span class="va">ana_rate_1</span> <span class="op">&lt;-</span> <span class="fl">1.10</span> <span class="co"># anagenesis rate</span></span>
<span></span>
<span><span class="va">clado_rate_2</span> <span class="op">&lt;-</span> <span class="fl">0.38</span> <span class="co"># cladogenesis rate</span></span>
<span><span class="va">ext_rate_2</span> <span class="op">&lt;-</span> <span class="va">ext_rate_1</span> <span class="co"># extinction rate</span></span>
<span><span class="va">clade_carr_cap_2</span> <span class="op">&lt;-</span> <span class="va">clade_carr_cap_1</span>  <span class="co"># clade-level carrying capacity</span></span>
<span><span class="va">imm_rate_2</span> <span class="op">&lt;-</span> <span class="va">imm_rate_1</span> <span class="co"># immigration rate</span></span>
<span><span class="va">ana_rate_2</span> <span class="op">&lt;-</span> <span class="va">ana_rate_1</span> <span class="co"># anagenesis rate</span></span>
<span></span>
<span><span class="va">island_replicates_2types</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DAISIE_sim.html">DAISIE_sim_cr</a></span><span class="op">(</span> </span>
<span>  time <span class="op">=</span> <span class="va">island_age</span>,</span>
<span>  M <span class="op">=</span> <span class="va">n_mainland_species</span>, </span>
<span>  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">clado_rate_1</span>, <span class="va">ext_rate_1</span>, <span class="va">clade_carr_cap_1</span>, <span class="va">imm_rate_1</span>, <span class="va">ana_rate_1</span>,</span>
<span>    <span class="va">clado_rate_2</span>, <span class="va">ext_rate_2</span>, <span class="va">clade_carr_cap_2</span>, <span class="va">imm_rate_2</span>, <span class="va">ana_rate_2</span></span>
<span>  <span class="op">)</span>,</span>
<span>  replicates <span class="op">=</span> <span class="va">n_replicates</span>, </span>
<span>  prop_type2_pool <span class="op">=</span> <span class="fl">0.163</span>,</span>
<span>  plot_sims <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DAISIE_plot_sims.html">DAISIE_plot_sims</a></span><span class="op">(</span><span class="va">island_replicates_2types</span><span class="op">)</span></span></code></pre></div>
<p><img src="demo_sim_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>This produces a figure similar to Fig. 2, with three plots: one for
the total number of species, one for species of type 1 and one for
species of type 2. Accessing each island replicate individually
(e.g. island_replicates_2types[[15]]) shows information on branching
times and species-through-time tables for total, type 1 species and type
2 species.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rampal S. Etienne, Luis Valente, Albert B. Phillimore, Bart Haegeman, Joshua W. Lambert, Pedro Santos Neves, Shu Xie, Richèl J.C. Bilderbeek, Hanno Hildenbrandt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
